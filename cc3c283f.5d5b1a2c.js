(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{85:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return i})),t.d(n,"metadata",(function(){return c})),t.d(n,"toc",(function(){return o})),t.d(n,"default",(function(){return d}));var a=t(3),r=t(7),s=(t(0),t(90)),i={id:"balances",title:"Display Balances",image:"/img/marina_logo.svg"},c={unversionedId:"marina/balances",id:"marina/balances",isDocsHomePage:!1,title:"Display Balances",description:"Once the user accepted the request to connect with your application, you can access his addresses and relative blinding keys. This can compromise user privacy, be very mindful how you handle this secret material, altough you cannot spend or put user's funds at risks.",source:"@site/docs/marina/balances.md",slug:"/marina/balances",permalink:"/marina/balances",editUrl:"https://github.com/vulpemventures/docs.vulpem.com/edit/master/docs/docs/marina/balances.md",version:"current",sidebar:"docs",previous:{title:"Connect to Marina",permalink:"/marina/connect"},next:{title:"Transaction",permalink:"/marina/transaction"}},o=[{value:"New address",id:"new-address",children:[]},{value:"New change address",id:"new-change-address",children:[]},{value:"All addresses",id:"all-addresses",children:[]},{value:"Unblinded Utxos",id:"unblinded-utxos",children:[]},{value:"All transactions",id:"all-transactions",children:[]}],l={toc:o};function d(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(a.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(s.b)("p",null,"Once the user accepted the request to ",Object(s.b)("a",{parentName:"p",href:"/marina/connect"},"connect")," with your application, you can access his addresses and relative blinding keys. This can compromise user privacy, be very mindful how you handle this secret material, altough you cannot spend or put user's funds at risks."),Object(s.b)("p",null,"In order to have the app to build an unsigned transaction on behalf of the user, one must be able to access the user's addresses and blinders necessary to reveal user's asset and amounts held by those addresses."),Object(s.b)("h2",{id:"new-address"},"New address"),Object(s.b)("p",null,"Derive a new confidential address and his blinding key for receiving funds."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"await window.marina.getNextAddress();\n/*\n{\n  publicKey: string;\n  script: string;\n  derivationPath?: string;\n  unconfidentialAddress?: string;\n  confidentialAddress?: string;\n  blindingPrivateKey?: string;\n}\n*/\n")),Object(s.b)("h2",{id:"new-change-address"},"New change address"),Object(s.b)("p",null,"Derive a new confidential address and his blinding key to be used as ",Object(s.b)("strong",{parentName:"p"},"change")," output"),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"await window.marina.getNextChangeAddress();\n")),Object(s.b)("h2",{id:"all-addresses"},"All addresses"),Object(s.b)("p",null,"Retrieve all derived confidential addresses with blinding keys till now"),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"await window.marina.getAddresses();\n")),Object(s.b)("p",null,"##\xa0Balances"),Object(s.b)("p",null,"Retrieve all balances for all accounts held by the user"),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"await window.marina.getBalances();\n/*\n[{\n  asset: Asset, \n  amount: number // expressed in satoshis\n}]\n*/\n")),Object(s.b)("p",null,Object(s.b)("inlineCode",{parentName:"p"},"Asset")," objects contains data fetched from the liquid asset registry."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-ts"},"export interface Asset {\n  assetHash: string;\n  name: string;\n  precision: number;\n  ticker: string;\n};\n")),Object(s.b)("h2",{id:"unblinded-utxos"},"Unblinded Utxos"),Object(s.b)("p",null,"Marina is unblinding UTXOs for you. Retrieve all the unblinded UTXOs:"),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"await window.marina.getCoins();\n")),Object(s.b)("p",null,"Returns a list of ",Object(s.b)("a",{parentName:"p",href:"https://github.com/vulpemventures/marina-provider/blob/master/src/types.ts#L67"},"Utxo"),". It contains unblinded asset/value pair, the blinding factors and data about the locking script. All the utxos returned by this method will be signed if passed via a pset to ",Object(s.b)("inlineCode",{parentName:"p"},"marina.signTransaction")," method."),Object(s.b)("blockquote",null,Object(s.b)("p",{parentName:"blockquote"},"\u26a0\ufe0f ",Object(s.b)("strong",{parentName:"p"},"Warning"),": UTXOs could be unconfidential, in this case blinding factors will be a 32 bytes buffer filled with 0s.")),Object(s.b)("h2",{id:"all-transactions"},"All transactions"),Object(s.b)("p",null,"Marina is fetching all the transaction related to your addresses, confirmed and unconfirmed."),Object(s.b)("pre",null,Object(s.b)("code",{parentName:"pre",className:"language-js"},"await window.marina.getTransactions();\n/*\n[{\n  txId: string;\n  hex?: string; // marina is async, it's possible that hex is not fetched yet\n  height: number; // 0 means unconfirmed\n  explorerURL: string; // link to explorer page with revealed confidential data\n}]\n*/\n")))}d.isMDXComponent=!0},90:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return m}));var a=t(0),r=t.n(a);function s(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function c(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){s(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=r.a.createContext({}),d=function(e){var n=r.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):c(c({},n),e)),t},u=function(e){var n=d(e.components);return r.a.createElement(l.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},p=r.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,s=e.originalType,i=e.parentName,l=o(e,["components","mdxType","originalType","parentName"]),u=d(t),p=a,m=u["".concat(i,".").concat(p)]||u[p]||b[p]||s;return t?r.a.createElement(m,c(c({ref:n},l),{},{components:t})):r.a.createElement(m,c({ref:n},l))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var s=t.length,i=new Array(s);i[0]=p;var c={};for(var o in n)hasOwnProperty.call(n,o)&&(c[o]=n[o]);c.originalType=e,c.mdxType="string"==typeof e?e:a,i[1]=c;for(var l=2;l<s;l++)i[l]=t[l];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,t)}p.displayName="MDXCreateElement"}}]);